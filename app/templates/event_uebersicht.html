<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>EventÃ¼bersicht</title>
</head>
<body>
    <h1>VerkÃ¤ufe pro Teilnehmer</h1>

    <form method="GET">
        <label for="event_id">Event wÃ¤hlen:</label>
        <select name="event_id" id="event_id" onchange="this.form.submit()">
            <option value="">-- wÃ¤hlen --</option>
            {% for event in events %}
                <option value="{{ event.id }}" {% if selected_event_id == event.id %}selected{% endif %}>
                    {{ event.name }} â€“ {{ event.datum }}
                </option>
            {% endfor %}
        </select>
    </form>

    {% if selected_event_id %}
        <p>
            ğŸ“¥ <a href="{{ url_for('export_csv', event_id=selected_event_id) }}">Teilnehmer-Export (CSV)</a> |
            ğŸ“„ <a href="{{ url_for('export_event_uebersicht_pdf', event_id=selected_event_id) }}" target="_blank">PDF</a>
        </p>
    {% endif %}

    <p>
        ğŸ“Š <a href="{{ url_for('export_umsatz') }}">Gesamt-UmsatzÃ¼bersicht (CSV)</a>
    </p>

    {% if daten %}
        <hr>
        {% for eintrag in daten %}
            <h3>{{ eintrag.teilnehmer }} â€“ <small>Status: {{ eintrag.status|capitalize }}</small></h3>
            {% if eintrag.buchungen %}
                <ul>
                {% for buchung in eintrag.buchungen %}
                    <li>{{ buchung[0] }}: {{ buchung[1] }} StÃ¼ck â€“ {{ "%.2f"|format(buchung[2]) }} CHF</li>
                {% endfor %}
                </ul>
                <strong>Gesamtsumme: {{ "%.2f"|format(eintrag.gesamt) }} CHF</strong>
            {% else %}
                <p><em>Keine Buchungen</em></p>
            {% endif %}
        {% endfor %}
    {% endif %}

    <br><a href="{{ url_for('index') }}">ZurÃ¼ck zur Startseite</a>
</body>
</html>
